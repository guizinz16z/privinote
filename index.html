<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Privinote</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --bg-dark: linear-gradient(135deg,#0f2027,#203a43,#2c5364);
  --bg-light: linear-gradient(135deg,#f5f7fa,#c3cfe2);
  --box-dark: rgba(0,0,0,.65);
  --box-light: rgba(255,255,255,.85);
  --text-dark:#fff;
  --text-light:#000;
}

body{
  margin:0;
  font-family:Arial,sans-serif;
  background:var(--bg-dark);
  color:var(--text-dark);
  height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;
  transition:.4s;
}

body.light{
  background:var(--bg-light);
  color:var(--text-light);
}

.box{
  background:var(--box-dark);
  padding:22px;
  border-radius:14px;
  max-width:420px;
  width:100%;
  text-align:center;
  box-shadow:0 20px 40px rgba(0,0,0,.4);
  animation:slide .5s ease;
  z-index:2;
}

body.light .box{background:var(--box-light);}

@keyframes slide{
  from{transform:translateY(25px);opacity:0}
  to{transform:none;opacity:1}
}

textarea{
  width:100%;
  height:120px;
  border-radius:10px;
  border:none;
  padding:12px;
  font-size:16px;
  resize:none;
}

button{
  width:100%;
  padding:12px;
  border:none;
  border-radius:10px;
  font-size:16px;
  cursor:pointer;
  margin-top:8px;
  background:linear-gradient(135deg,#00c6ff,#0072ff);
  color:#fff;
  transition:.2s;
}

button:hover{transform:scale(1.04)}

.danger{
  background:linear-gradient(135deg,#ff416c,#ff4b2b);
  font-weight:bold;
}

.copy-btn{
  background:#00ffcc;
  color:#000;
  font-weight:bold;
}

.link{
  word-break:break-all;
  font-size:14px;
  color:#00ffcc;
  margin-top:10px;
}

.footer{
  margin-top:14px;
  font-size:12px;
  opacity:.7;
}

.footer a{color:#00c6ff;text-decoration:none;font-weight:bold}

.legal{font-size:11px;opacity:.5;margin-top:5px}

/* TOGGLE */
.toggle{
  position:fixed;
  top:15px;
  right:15px;
  z-index:5;
  font-size:20px;
  background:none;
  border:none;
  cursor:pointer;
}

/* EXPLOS√ÉO */
.flash{
  position:fixed;
  inset:0;
  background:#fff;
  opacity:0;
  z-index:1;
}

.flash.active{
  animation:flash .5s;
}

@keyframes flash{
  0%{opacity:0}
  30%{opacity:1}
  100%{opacity:0}
}

.shake{
  animation:shake .4s;
}

@keyframes shake{
  0%{transform:translate(0)}
  25%{transform:translate(-5px,5px)}
  50%{transform:translate(5px,-5px)}
  75%{transform:translate(-5px,5px)}
  100%{transform:translate(0)}
}
</style>
</head>
<body>

<button class="toggle" onclick="toggleTheme()">üåô</button>
<div class="flash" id="flash"></div>

<!-- CRIAR -->
<div class="box" id="create">
<h2>üîê Criar mensagem secreta</h2>
<textarea id="text" placeholder="Digite sua mensagem secreta..."></textarea>
<button onclick="createNote()">Criar link secreto</button>

<div id="linkBox" style="display:none">
  <div class="link" id="result"></div>
  <button class="copy-btn" onclick="copyLink()">üìã Copiar link</button>
</div>

<div class="footer">
Criado por <a href="https://t.me/Guizin16z" target="_blank">@Guizin16z</a>
<div class="legal">N√£o utilize para atividades ilegais.</div>
</div>
</div>

<!-- QUEBRA -->
<div class="box" id="breaker" style="display:none">
<h2>‚ö†Ô∏è Mensagem protegida</h2>
<p>Ao quebrar, a mensagem ser√° destru√≠da.</p>
<button class="danger" onclick="breakNote()">üí£ Quebrar nota</button>
<button onclick="goCreate()">‚ûï Criar nova nota</button>
</div>

<!-- VIEW -->
<div class="box" id="view" style="display:none">
<h2>üì© Mensagem secreta</h2>
<p id="message"></p>
<button onclick="goCreate()">‚ûï Criar nova nota</button>
</div>

<script type="module">
import {initializeApp} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {getFirestore,doc,setDoc,getDoc,deleteDoc} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig={
apiKey:"AIzaSyBHOFAcNcQ-397zebLS_n0G8M4meM7hVq8",
authDomain:"privinote.firebaseapp.com",
projectId:"privinote",
storageBucket:"privinote.firebasestorage.app",
messagingSenderId:"583662739248",
appId:"1:583662739248:web:ba624aa2e0cd070a0272f5"
};

const app=initializeApp(firebaseConfig);
const db=getFirestore(app);

const params=new URLSearchParams(location.search);
const id=params.get("id");

const create=document.getElementById("create");
const breaker=document.getElementById("breaker");
const view=document.getElementById("view");
const msg=document.getElementById("message");
const flash=document.getElementById("flash");

if(id){create.style.display="none";breaker.style.display="block"}

window.breakNote=async()=>{
flash.classList.add("active");
document.body.classList.add("shake");

setTimeout(async()=>{
breaker.style.display="none";
view.style.display="block";
flash.classList.remove("active");
document.body.classList.remove("shake");

const ref=doc(db,"notes",id);
const snap=await getDoc(ref);

if(!snap.exists()){
msg.innerText="‚ùå Mensagem j√° destru√≠da.";
}else{
msg.innerText=snap.data().text;
await deleteDoc(ref);
}
},500);
}

window.createNote=async()=>{
const text=document.getElementById("text").value.trim();
if(!text)return alert("Digite uma mensagem");
const id=Math.random().toString(36).substring(2,10);
await setDoc(doc(db,"notes",id),{text,createdAt:Date.now()});
document.getElementById("result").innerText=`${location.origin}${location.pathname}?id=${id}`;
document.getElementById("linkBox").style.display="block";
}

window.copyLink=()=>navigator.clipboard.writeText(result.innerText);

window.goCreate=()=>location.href=location.pathname;

// THEME
function toggleTheme(){
document.body.classList.toggle("light");
localStorage.setItem("theme",document.body.classList.contains("light")?"light":"dark");
}
if(localStorage.getItem("theme")==="light")document.body.classList.add("light");
</script>

</body>
</html>
